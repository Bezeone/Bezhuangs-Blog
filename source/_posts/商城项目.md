---
title: 商城项目
date: 2023-06-25
tags: []
categories: Java
references:
  - title: J2EE
    url: https://java.withubtraining.org/
---

> Java 电子商城系统是我参与的 Java 培训班的毕业项目。项目采用互联网的主流技术，代码规范简洁，流程完整、功能丰富，包括商品管理、订单管理、用户管理等功能。以下为我总结的项目构建过程中的技术选型、数据库设计与表设计、开发重难点以及后续微服务，可供参考。

<!--more-->

### 一、项目技术选型

专业的技术选型和组合使得构建一个功能完善、用户友好的电子商城系统可以具备高效、可靠和可扩展的特性，能够满足现代电商应用的需求和挑战。

首先，我们选择了 Spring Boot 作为项目的基础框架，它提供了一套强大而灵活的工具和库，能够快速构建可独立部署的 Java 应用程序。为了有效管理项目的依赖项和构建过程，我采用了 Maven 作为项目管理工具。为了实现持久化数据存储和与 MySQL 数据库的交互，我使用了 MyBatis 作为持久层框架。通过使用 MyBatis，我可以简化数据库操作并提高应用程序的性能和可维护性。为了更加高效地进行数据库表结构到 Java 实体类和映射文件的转换，我使用了 MyBatis Generator 插件，它能够自动生成相应的代码，减少了手动编写的工作量。

为了增强系统的性能和扩展性，我引入了 Redis 作为缓存和数据存储的解决方案。Redis 是一个高性能的内存数据库，它支持多种数据结构和复杂的操作，能够快速地处理大量并发请求。为了有效管理和记录系统的日志信息，我选择了 Log4j2 作为日志管理工具。它提供了丰富的日志级别和配置选项，使得日志的记录和追踪变得更加方便和可控。为了方便 API 的设计、构建和文档化，我采用了 Swagger 工具集。Swagger 提供了一套强大的工具和界面，使得开发人员能够快速了解 API 的功能和使用方法，并生成清晰的 API 文档。

前端部分我们选择了HTML、CSS和JavaScript进行开发，并使用了Vue.js作为前端框架。Vue.js的组件化和响应式特性为我们开发复杂的前端界面提供了很大的便利。

最后，为了实现横切关注点的分离和代码的模块化，我使用了AOP（面向切面编程）技术。通过AOP，我可以将日志记录、事务管理、权限控制等通用功能与业务逻辑相分离，提高了代码的可重用性和可维护性。

### 二、项目功能和模块设计

前台展示：

-   用户模块
-   商品分类
-   商品信息
-   网站公告
-   购物车
-   订单

后台管理：

-   用户模块
-   商品分类
-   商品信息
-   网站公告
-   订单

### 三、数据库设计和表设计

通过合理的表设计，我们能够高效地存储和检索数据，满足项目的各项需求：

buycart 表：
- id: 主键，购物车项的唯一标识
- username: 用户名，关联到 member 表的用户名
- pid: 商品 ID，关联到 product 表的商品 ID
- quantity: 商品数量
- type: 商品类型

category 表：
- id: 主键，类别的唯一标识
- name: 类别名称
- parentId: 父级类别 ID
- level: 类别级别
- status: 类别状态，0 表示启用，1 表示停用

member 表：
- id: 主键，会员的唯一标识
- username: 用户名
- password: 密码
- email: 邮箱
- mobile: 手机号
- sex: 性别
- birthday: 生日
- level: 会员等级，0表示普通会员，1表示超级会员
- identityCard: 身份证号

member_auth 表：
- username: 用户名，关联到 member 表的用户名
- token: 认证令牌

notice 表：
- id: 主键，公告的唯一标识
- title: 公告标题
- createDate: 创建日期
- status: 公告状态，0 表示启用，1 表示停用

orders 表：
- id: 主键，订单的唯一标识
- sn: 订单号
- username: 用户名，关联到 member 表的用户名
- price: 订单价格
- createDate: 创建日期
- status: 订单状态，0 表示待付款，1 表示已付款，2 表示已发货

orders_detail 表：
- id: 主键，订单详情的唯一标识
- sn: 订单号，关联到 orders 表的订单号
- pid: 商品 ID，关联到 product 表的商品 ID
- quantity: 商品数量
- totalPrice: 商品总价
- createDate: 创建日期
- type: 商品类型

product 表：
- id: 主键，商品的唯一标识
- name: 商品名称
- brand: 商品品牌
- categoryLevel3Id: 三级类别 ID，关联到 category 表的类别 ID
- categoryLevel2Id: 二级类别 ID，关联到 category 表的类别 ID
- categoryLevel1Id: 一级类别 ID，关联到 category 表的类别 ID
- price: 商品价格
- types: 商品类型
- stock: 商品库存
- bigImg: 商品大图
- imgs: 商品图片列表
- description: 商品描述
- hot: 商品热度

以上是商城数据库设计和表设计的描述。这些表之间通过外键关联进行数据关联和查询。

### 四、项目重难点总结

1. 统一响应对象：为了统一接口的返回格式，我们设计了一个统一的响应对象，包括响应状态码、响应消息和响应数据。这样可以方便前端对接口进行处理，并提高开发效率。

2. 登录状态保持：为了保持用户的登录状态，在客户端与服务端之间需要进行身份验证和状态维护。我们采用了 Token-based 的身份验证机制，使用 JWT（JSON Web Token）来生成和验证身份令牌。

3. 统一异常处理：为了更好地处理异常情况，我们实现了一个统一的异常处理机制。通过捕获和处理异常，我们能够提供有意义的错误信息，并对异常进行适当的日志记录和处理。

4. 参数校验：为了保证输入数据的合法性和完整性，我们使用了参数校验框架，如 Hibernate Validator，对请求参数进行验证。这样可以在接口层面上减少无效的请求，提高系统的安全性和稳定性。

5. Swagger：为了方便 API 的文档编写和维护，我们引入了 Swagger 框架。通过 Swagger，我们能够自动生成 API 文档，并提供一个可视化的界面供开发人员和测试人员使用。

6. 统一鉴权：为了控制接口的访问权限，我们实现了一个统一的鉴权机制。通过在请求中携带访问令牌，并进行有效性验证，我们可以确保只有具有权限的用户能够访问敏感接口。

7. Redis 整合：为了提高系统的性能和并发处理能力，我们引入了Redis作为缓存系统。通过将热点数据存储在 Redis 中，我们能够快速地响应用户请求，减轻数据库的压力。

8. 调试：在开发过程中，我们遇到了一些难以复现和排查的问题。通过适当的日志记录和调试技巧，我们能够更快地定位问题，并进行修复。

9. 商品的搜索、排序、目录查询：为了提供更好的用户体验，我们实现了商品的搜索、排序和目录查询功能。通过合理的数据索引和查询优化，我们能够快速地响应用户的搜索请求。

10. MyBatis 返回非标准对象：在使用 MyBatis 进行数据库操作时，我们遇到了一些复杂查询需求，无法直接映射到标准的数据对象上。通过自定义的 ResultMap 和 ResultHandler，我们成功地返回了非标准的查询结果。

11. 后期计算单样商品的总价、不同逻辑、越权判断：在订单管理中，我们需要考虑到不同商品的价格计算逻辑以及越权问题。通过细致的设计和严格的权限验证，我们确保了订单计算的准确性和安全性。

12. VO 的封装、裁剪：为了减少数据传输和保护用户隐私，我们对返回给前端的数据进行了封装和裁剪。通过定义视图对象（VO）来返回仅包含必要信息的数据，我们能够提高系统的性能和安全性。

13. 一个订单内包含多个商品、订单状态流转：在订单管理中，我们需要处理一个订单中包含多个商品的情况，并设计订单状态的流转。通过合理的数据模型设计和状态管理，我们能够有效地处理订单的复杂场景。

14. 二维码生成：为了支持订单的支付和物流跟踪，我们引入了二维码生成功能。通过生成唯一的订单二维码，我们能够方便地进行支付和物流信息的扫描和查询。

15. JWT 企业级用户验证：为了满足企业级用户的验证需求，我们在 JWT 的基础上进行了进一步的定制化开发。通过加密算法、签名验证和 Token 管理，我们能够提供安全可靠的用户验证解决方案。

16. 后台管理模块采用 Spring Security 来实现权限管理和认证。其中的权限管理和认证功能对于保护敏感数据和控制用户访问权限至关重要。在实现过程中，需要定义角色和权限，并配置安全策略，以确保只有经过认证的用户能够访问受限资源。此外，还需要处理用户认证、密码加密和会话管理等问题，以提供安全可靠的后台管理功能。

这些重难点都是我们在项目中所遇到的挑战，通过团队的共同努力和持续学习，我们成功地克服了这些问题，并构建了一个稳定和可靠的电子商城系统。

### 五、微服务架构改造

随着项目的发展，我们将系统改造为微服务架构。通过将各个功能模块拆分成独立的服务，实现系统的分布式拆分，能够提高系统的可伸缩性和灵活性，并达到高可用、高性能、可伸缩的架构目标。

1.  使用 Spring Cloud 微服务实现分布式构建：将各个功能模块拆分成独立的服务，每个服务负责特定的业务功能。通过 Spring Cloud 提供的服务注册与发现机制（如Eureka或Consul），实现服务之间的通信与协调。
2.  使用 Spring Cloud Config 实现分布式配置中心：通过将配置文件集中管理，可以减少配置的冗余和维护成本。Spring Cloud Config 提供了一种集中式的方式来管理配置，同时支持配置的动态更新。
3.  使用 Spring Cloud Gateway 作为网关实现：Spring Cloud Gateway 是 Spring Cloud 提供的网关组件，可以实现请求的转发和路由，同时提供一些常见的网关功能，如负载均衡、限流等。
4.  使用 Gateway 网关实现统一鉴权：通过 Gateway 网关可以实现统一的鉴权功能，对请求进行认证和授权，确保只有经过认证的用户能够访问相应的资源。
5.  使用 Spring Cloud Bus 实现消息总线功能：通过消息总线，可以实现配置的自动刷新和事件的广播。当配置中心的配置发生变化时，Spring Cloud Bus 可以将变更信息广播给其他服务，从而实现配置的实时更新。
6.  使用 OpenFeign 进行远程调用实现：OpenFeign 是 Spring Cloud 提供的声明式的远程调用框架，可以简化微服务之间的通信，减少手动编写接口调用代码的工作量。
7.  订单模块多实例集群实现：为了提高系统的性能和可靠性，可以将订单模块部署在多个实例上，组成一个集群，通过负载均衡来分担请求压力和提供高可用性。
8.  使用 Docker 来管理 Redis、MySQL 等：通过使用 Docker 容器化技术，可以方便地管理和部署 Redis、MySQL 等数据库，简化环境配置和管理过程。
9.  Redis 热点数据缓存，提高 QPS：利用 Redis 作为缓存层，将热点数据存储在内存中，可以提高系统的响应速度和吞吐量，减轻数据库的负载。
10.  使用 RabbitMQ 实现支付异步回调消息队列化：通过将支付异步回调请求发送到消息队列中，可以实现异步处理，避免阻塞并提高系统的可靠性和性能。

### 五、结语

![](https://blog.zhuangzhihao.top/img/J2EE.png)

在 Java 培训班的毕业项目中，我们成功构建了一个功能完善的电子商城系统，展现了团队的努力和智慧。通过合理的技术选型、精心的数据库设计和表设计，我们为用户提供了一个便捷、安全的购物平台。在开发过程中，我们攻克了各种开发重难点，如统一响应对象、登录状态保持、统一异常处理、参数校验等。同时，我们规划并参与开发了后续的微服务架构，以提升系统的可扩展性和灵活性。这个项目不仅是我们在 Java 培训中所学知识的应用，也深刻体现了团队合作和持续学习的重要性。我们为完成这个项目感到自豪，并期待在未来的工作中继续提升和创新。
