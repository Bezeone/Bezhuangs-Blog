---
title: 机器学习和深度学习介绍和入门
date: 2021-09-23
updated: 2021-09-25
tags: [d2l.ai]
categories: 人工智能与机器学习
references:
  - title: 动手学深度学习
    url: https://zh-v2.d2l.ai/index.html
---

> 就在过去的五年里，深度学习给世界带来了惊喜，推动了计算机视觉、自然语言处理、自动语音识别、强化学习和统计建模等领域的快速发展。我选择李沐老师的动手学深度学习 v2 课程来开启机器学习之旅，并特别关注深度学习（deep learning，DL）的基础知识深度学习。以下为学习 d2l 课程第一章所记笔记，可供参考。

<!--more-->

### 日常生活中的机器学习

- 机器学习（machine learning，ML）是一类强大的可以从经验中学习的技术。 通常采用观测数据或与环境交互的形式，机器学习算法会积累更多的经验，其性能也会逐步提高
- 收集一个包含音频样本的巨大的数据集（dataset），并对包含和不包含唤醒词的样本进行标记
- 通过机器学习算法，我们不需要设计一个“明确地”识别唤醒词的系统。 相反，我们定义一个灵活的程序算法，其输出由许多参数（parameter）决定。 然后我们使用数据集来确定当下的“最佳参数集”，这些参数通过某种性能度量来获取完成任务的最佳性能
- 把参数看作是旋钮，我们可以转动旋钮来调整程序的行为。 任一调整参数后的程序，我们称为模型（model）
- 通过操作参数而生成的所有不同程序（输入-输出映射）的集合称为“模型族”
- 使用数据集来选择参数的元程序被称为学习算法（learning algorithm）
- 在我们开始用机器学习算法解决问题之前，我们必须精确地定义问题，确定输入（input）和输出（output）的性质，并选择合适的模型族
- 在机器学习中，学习（learning）是一个训练模型的过程。 通过这个过程，我们可以发现正确的参数集，从而使模型强制执行所需的行为。 换句话说，我们用数据训练（train）我们的模型
- 训练过程通常包含如下步骤：
  1. 从一个随机初始化参数的模型开始，这个模型基本毫不“智能”。
  2. 获取一些数据样本（例如，音频片段以及对应的{是,否}{是,否}标签）。
  3. 调整参数，使模型在这些样本中表现得更好。
  4. 重复第2步和第3步，直到模型在任务中的表现令你满意。

### 机器学习的关键组件

#### 数据

- 每个数据集由一个个样本（example, sample）组成，大多时候，它们遵循独立同分布（independently and identically distributed, i.i.d.）
-  样本有时也叫做数据点（data point）或者数据实例（data instance），通常每个样本由一组称为特征（features，或*协变量*（covariates））的属性组成，机器学习模型会根据这些属性进行预测
- 在监督学习问题中，要预测的是一个特殊的属性，它被称为标签（label，或目标（target））
- 当每个样本的特征类别数量都是相同的时候，其特征向量是固定长度的，这个长度被称为数据的维数（dimensionality）。 固定长度的特征向量是一个方便的属性，它有助于我们量化学习大量样本
- 然而，并不是所有的数据都可以用“固定长度”的向量表示，例如文本数据。与传统机器学习方法相比，深度学习的一个主要优势是可以处理不同长度的数据
- 一般来说，我们拥有的数据越多，通常可以训练出更强大的模型，从而减少对预先设想假设的依赖。 数据集的由小变大为现代深度学习的成功奠定基础。 在没有大数据集的情况下，许多令人兴奋的深度学习模型黯然失色。 就算一些深度学习模型在小数据集上能够工作，但其效能并不比传统方法高。
- 仅仅拥有海量的数据是不够的，我们还需要正确的数据。 如果数据中充满了错误，或者如果数据的特征不能预测任务目标，那么模型很可能无效。
- 此外，糟糕的预测性能甚至会加倍放大事态的严重性。 在一些敏感应用中，如预测性监管、简历筛选和用于贷款的风险模型，我们必须特别警惕垃圾数据带来的后果。一种常见的问题来自不均衡的数据集，比如在一个有关医疗的训练数据集中，某些人群没有样本表示。
- 当数据不具有充分代表性，甚至包含了一些社会偏见时，模型就很有可能有偏见。

#### 模型

- 大多数机器学习会涉及到数据的转换。 比如，我们建立一个“摄取照片并预测笑脸”的系统。 
- 深度学习与经典方法的区别主要在于：前者关注的功能强大的模型，这些模型由神经网络错综复杂的交织在一起，包含层层数据转换，因此被称为深度学习（deep learning）

#### 目标函数

- 在机器学习中，我们需要定义模型的优劣程度的度量，这个度量在大多数情况是“可优化”的，我们称之为目标函数（objective function）
- 我们通常定义一个目标函数，并希望优化它到最低点。 因为越低越好，所以这些函数有时被称为损失函数（loss function，或cost function）。 但这只是一个惯例，你也可以取一个新的函数，优化到它的最高点。 这两个函数本质上是相同的，只是翻转一下符号。
- 当任务在试图预测数值时，最常见的损失函数是平方误差（squared error），即预测值与实际值之差的平方
- 当试图解决分类问题时，最常见的目标函数是最小化错误率，即预测与实际情况不符的样本比例。
- 有些目标函数（如平方误差）很容易被优化，有些目标（如错误率）由于不可微性或其他复杂性难以直接优化。 在这些情况下，通常会优化替代目标。
- 通常，损失函数是根据模型参数定义的，并取决于数据集。 在一个数据集上，我们通过最小化总损失来学习模型参数的最佳值。 该数据集由一些为训练而收集的样本组成，称为训练数据集（training dataset，或称为训练集（training set））
- 然而，在训练数据上表现良好的模型，并不一定在“新数据集”上有同样的效能，这里的“新数据集”通常称为测试数据集（test dataset，或称为测试集（test set））
- 综上所述，我们通常将可用数据集分成两部分：训练数据集用于拟合模型参数，测试数据集用于评估拟合的模型。 然后我们观察模型在这两部分数据集的效能。
- 

### 深度学习介绍

- 感知 -> 推理 -> 知识 -> 规划：自然语言处理 -> 计算机视觉 -> 深度学习
- 深度学习应用：图片地图、样式迁移、人脸合成、文字生成图片、文字生成、无人驾驶
- 案例研究：广告点击
  - 触发 -> 点击率预估 -> 排序（$点击率 * 竞价$）
  - 预测：特征提取 -> 模型 -> 点击率预测
  - 训练：训练数据（过去广告展现与用户点击） -> 特征和用户点击 -> 模型
  - 领域专家：点击 -> 展现
  - 数据科学家：数据 -> 模型（模型控制广告展现，这些用来训练新的模型）
  - AI 专家：提升模型精度和性能

### 安装动手学深度学习 v2

- 安装环境：Ubuntu 18.04 + build-essential + Python 3.8 + 

- 安装 Miniconda 到 `\root\miniconda3`

  ```bash
  wget https://repo.anaconda.com/miniconda/Miniconda3-py38_4.11.0-Linux-x86_64.sh
  bash Miniconda3-py38_4.11.0-Linux-x86_64.sh
  ```

- 安装其他软件包

  ```bash
  pip install jupyter d2l torch torchvision
  ```

- 拷贝 Jupyter 记事本

  ```bash
  wget https://zh-v2.d2l.ai/d2l-zh.zip
  git clone git@github.com:d2l-ai/d2l-zh-pytorch-slides.git
  ```

- 远程运行 Jupyter Notebook

  ```bash
  jupyter notebook --allow-root
  ```

- 将远端 localhost 映射到本地 localhost（端口 :8888）

  ```bash
  ssh -L8888:localhost:8888 root@106.15.200.147
  ```

- 安装 jupyter 插件

  ```bash
  pip install rise
  ```

  
